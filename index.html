<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- Styles -->
        <link rel="icon" type="image/png" href="images/dashboard.png" sizes="336x336">
        <link rel="stylesheet" href="css/index.css">

        <!-- Website title -->

        <title>Afstandsmåler - Arduino</title>
    </head>

    <body background="images/background.jpg"> 
        <!-- Top box -->
        <div class="headerContainer">
            <div class="boxTop">
                <h1 class="header">Afstandsmåler - Dashboard</h1> <br>
                <p class="underText"> Output fra Arduino</p>
            </div>
        </div>

        <!-- Middle boxes -->
        <div class="container">
            <div class="boxLeft">
                
            </div>
            <div class="boxMid">
                <!-- <h1 class="header" style="font-size: 30px;">Klokken</h1> -->
                <p class="clock" id="clock"></p>
                <p class="date" id="date"></p>
            </div>
            <div class="boxRight">
                <div class="weather">
                    <h2 style="top: 485px; right: 570px;">Weather</h2>
                    <iframe id="weather" src="https://www.yr.no/en/content/2-2614764/meteogram.svg"></iframe>
                </div>
            </div>
        </div>
        
        <!-- Scripts -->

        <script src="js/script.js"></script>
        <script src="js/date.js"></script>
        <!-- Arduino Data Output -->
        <script>
            // Function to fetch and display data
            function fetchData() {
                fetch('output.txt') // Opdater stien til at matche din filplacering
                    .then(response => response.text())
                    .then(data => {
                        const lines = data.trim().split('\n');
                        const values = lines.map(line => parseFloat(line));
        
                        if (values.length > 0) {
                            // Vælg de seneste 5 værdier ved at bruge slice
                            const latestValues = values.slice(-5);
        
                            // Filtrer ugyldige værdier
                            const validValues = latestValues.filter(value => !isNaN(value));
        
                            if (validValues.length > 0) {
                                // Opret en linje for "Latest Data"
                                let latestData = 'Latest Data:\n';
        
                                // Tilføj hver værdi på en ny linje
                                latestData += validValues.map(value => value.toString()).join('\n');
        
                                // Opdater indholdet af boxLeft div
                                document.querySelector('.boxLeft').innerText = latestData;
                            } else {
                                // Opdater indholdet af boxLeft div
                                document.querySelector('.boxLeft').innerText = 'Ingen gyldige data';
                            }
                        } else {
                            // Opdater indholdet af boxLeft div
                            document.querySelector('.boxLeft').innerText = 'Ingen data tilgængelig';
                        }
                    })
                    .catch(error => {
                        console.error('Fejl ved hentning af data:', error);
                    });
            }
        
            // Kald fetchData ved siden af sidenavigation
            document.addEventListener('DOMContentLoaded', fetchData);
        
            // Opsæt en timer til at kalde fetchData hvert sekund (1000 millisekunder)
            setInterval(fetchData, 1000);
        </script>
    </body>
</html>